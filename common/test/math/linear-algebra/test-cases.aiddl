(#mod self org.aiddl.linear-algebra.test)

(#namespace EVAL org.aiddl.eval)

(#req LA org.aiddl.common.math.linear-algebra)

(#symbolic matrix-mult org.aiddl.common.linear-algebra.matrix-mult)
(#symbolic vector-mult org.aiddl.common.linear-algebra.vector-mult)

(Matrix A
  (
    (1.0 2.0 3.0)
    (4.0 5.0 6.0)
    (7.0 8.0 9.0) ))
    
(Matrix B
  (
    (1.0 0.0 0.0)
    (0.0 1.0 0.0)
    (0.0 0.0 1.0) ))

(#assert t1
    (=
      ($matrix-mult $A $B)
      $A))

(#assert t2 (type $A ^Matrix@LA))
         
(Matrix M1
  (
    (1.0 2.0 -3.0)
    (4.2 1.0 72.0)
    (0.0 -2.0 2.0)
  )
)

(#assert t3 (type $M1 ^Matrix@LA))

(Matrix M2
  (
    (1.0 0.0)
    (0.0 1.0 0.0)
    (0.0 0.0 1.0)
  )
)

(#assert t4 (not (type $M2 ^Matrix@LA)))

(Matrix M3
  ( )
)

(#assert t5 (type $M3 ^Matrix@LA))

(Vector v1 (1.0 2.0 3.0))

(#assert t6 (type $v1 ^Vector@LA))

(Vector v2 (1.1 2.5 a))

(#assert t7 (type $v1 ^Vector@LA))

(Matrix empty_1 (()))

(#assert t8 (type $empty_1 ^Matrix@LA))

(Matrix empty_2 ())

(#assert t9 (type $empty_2 ^Vector@LA))

(Matrix M_2x2_vars ((?A ?B)(?C ?D)))

(#assert t10 (not (type $M_2x2_vars ^Matrix@LA)))

(Vector empty_3 ())

(#assert t11 (type $empty_3 ^Vector@LA))
		